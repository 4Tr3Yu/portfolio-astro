---
import Layout from '../layouts/Layout.astro';
const lang = 'es';
---
<Layout title='Atre.dev | Full-stack Web Developer' description='Desarrollador Web Full-stack. Consultor de tecnologÃ­a' lang={lang}>
	<div class="w-full h-[80vh] flex justify-center flex-col items-center">
	<!-- 	<div class="border">

			<video id="video" width="300" height="300" autoplay></video>
		</div> -->
		<div class="border border-crimson">
			<div id="reader" style="width: 300px; height: 300px;"></div>
		</div>
		<button class="p-4 border border-crimson rounded-md mr-4 " id="start-qr">Start QR Scanning</button>
		<div id="result"></div>
	</div>
</Layout>
<script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
<script>
    //const video = document.getElementById('video') as HTMLVideoElement;
	const resultDiv = document.getElementById('result');


const html5QrCode  = new Html5Qrcode("reader");

function startQr() {
	const qrCodeSuccessCallback = (decodedText, decodedResult) => {
  	console.log("success")
	console.log("decoded", decodedText)  /* handle success */
	console.log("decoded result", decodedResult)  /* handle success */
	document.getElementById("result").innerText = `QR Code Result: ${decodedText}`;
	html5QrCode.stop();
};
const qrCodeErrorCallback = (errorMessage) => {
	// Handle error if needed
	console.warn(`QR Code scanning error: ${errorMessage}`);
};
	html5QrCode.start(
        { facingMode: "environment" }, // Use the rear camera
        { fps: 30, qrbox: 50 }, // FPS and QR box size
        qrCodeSuccessCallback,
        qrCodeErrorCallback
    ).catch(err => {
        console.error(`Unable to start scanning: ${err}`);
    });
}

document.getElementById('start-qr').addEventListener('click', startQr);
</script>